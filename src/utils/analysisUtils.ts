// 风格分析提示词模板
const STYLE_ANALYSIS_PROMPT = `# 文章风格提取提示词模板 v1.0
请输入您想要分析的文本段落。我将对其进行深度风格解析，并以结构化格式输出分析结果。
## 分析维度
我将从以下维度分析文本风格特征：
1. 语言特征（句式、用词、修辞）
2. 结构特征（段落、过渡、层次）
3. 叙事特征（视角、距离、时序）
4. 情感特征（浓淡、方式、基调）
5. 思维特征（逻辑、深度、节奏）
6. 个性标记（独特表达、意象系统）
7. 文化底蕴（典故、知识领域）
8. 韵律节奏（音节、停顿、节奏）
## 输出格式
我将以下列结构化格式以代码块输出分析结果：
\`\`\`json
{
"style_summary": "风格一句话概括",
"language": {
"sentence_pattern": ["主要句式特征", "次要句式特征"],
"word_choice": {
"formality_level": "正式度 1-5",
"preferred_words": ["高频特征词1", "特征词2"],
"avoided_words": ["规避词类1", "规避词类2"]
},
"rhetoric": ["主要修辞手法1", "修辞手法2"]
},
"structure": {
"paragraph_length": "段落平均字数",
"transition_style": "过渡特征",
"hierarchy_pattern": "层次展开方式"
},
"narrative": {
"perspective": "叙事视角",
"time_sequence": "时间处理方式",
"narrator_attitude": "叙事态度"
},
"emotion": {
"intensity": "情感强度 1-5",
"expression_style": "表达方式",
"tone": "情感基调"
},
"thinking": {
"logic_pattern": "思维推进方式",
"depth": "思维深度 1-5",
"rhythm": "思维节奏特征"
},
"uniqueness": {
"signature_phrases": ["标志性表达1", "表达2"],
"imagery_system": ["核心意象1", "意象2"]
},
"cultural": {
"allusions": ["典故类型", "使用频率"],
"knowledge_domains": ["涉及领域1", "领域2"]
},
"rhythm": {
"syllable_pattern": "音节特征",
"pause_pattern": "停顿规律",
"tempo": "节奏特征"
}
}
\`\`\`
## 注意：
1. 文中提及的特殊要素不要提取，例如书名、作者姓名、特定地理位置等。
2. 风格提取的目的在于基于该风格生成其他指定主题的文章，提取要素应当基于这一任务。
`;

/**
 * 分析文章风格
 * @param text 要分析的文本
 * @returns 分析结果对象
 */
export async function analyzeStyle(text: string): Promise<any> {
  // 实际实现中，这里应该调用大语言模型API
  // 将STYLE_ANALYSIS_PROMPT和用户输入的text一起发送给API
  // 并解析返回的JSON结果
  
  // 这里使用模拟数据进行演示
  await new Promise(resolve => setTimeout(resolve, 2000));
  
  // 模拟API返回的分析结果
  return {
    "style_summary": "文艺清新描述型散文",
    "language": {
      "sentence_pattern": ["短句与长句交替", "排比句", "省略句"],
      "word_choice": {
        "formality_level": "3",
        "preferred_words": ["悠然", "恍惚", "微澜", "静谧", "氤氲"],
        "avoided_words": ["严肃术语", "强烈情感词", "俚语俗语"]
      },
      "rhetoric": ["拟人", "比喻", "排比", "象征"]
    },
    "structure": {
      "paragraph_length": "短段落，平均50-80字",
      "transition_style": "场景转换流畅，多用环境变化作为过渡",
      "hierarchy_pattern": "先整体后细节，由表及里"
    },
    "narrative": {
      "perspective": "第一人称观察者",
      "time_sequence": "线性推进，偶有闪回",
      "narrator_attitude": "温和客观，略带感怀"
    },
    "emotion": {
      "intensity": "2",
      "expression_style": "含蓄内敛，通过细节暗示",
      "tone": "平静中带有一丝怀旧与温暖"
    },
    "thinking": {
      "logic_pattern": "随感而发，意识流",
      "depth": "4",
      "rhythm": "缓慢从容，有波澜但不激烈"
    },
    "uniqueness": {
      "signature_phrases": ["如同...一般", "仿佛置身于...", "在那一刻"],
      "imagery_system": ["自然景象", "光影变化", "水的意象"]
    },
    "cultural": {
      "allusions": ["文学引用", "偶尔"],
      "knowledge_domains": ["自然", "日常生活", "人文艺术"]
    },
    "rhythm": {
      "syllable_pattern": "长短句结合，注重音韵美感",
      "pause_pattern": "自然停顿，不刻意强调",
      "tempo": "舒缓平稳，如流水般自然"
    }
  };
}

// 文章仿写提示词模板
export const TEXT_MIMIC_PROMPT = `# 文章仿写提示词模板 v1.0
基于上述文本风格，为我编写一篇1000字的文章，要求如下：
关键词：{keywords}

注意：
- 禁止使用"让我想起…""这让我想起…""我不由得想起…"等回忆性过渡句
- 避免刻意煽情或直白的情感表达
- 采用自然段落输出，不使用标题和小标题`;

/**
 * 生成仿写文章
 * @param styleAnalysis 风格分析结果
 * @param keywords 用户输入的关键词
 * @returns 生成的文章内容
 */
export async function generateMimicText(styleAnalysis: any, keywords: string): Promise<string> {
  // 实际实现中，这里应该调用大语言模型API
  // 将styleAnalysis、TEXT_MIMIC_PROMPT和keywords一起发送给API
  
  // 构建完整的提示词
  const prompt = TEXT_MIMIC_PROMPT.replace('{keywords}', keywords);
  
  // 这里使用模拟数据进行演示
  await new Promise(resolve => setTimeout(resolve, 3000));
  
  // 根据风格特征生成相应的文章内容
  const styleType = styleAnalysis.style_summary;
  const preferredWords = styleAnalysis.language.word_choice.preferred_words;
  const sentencePatterns = styleAnalysis.language.sentence_pattern;
  
  // 模拟不同风格生成不同文章
  let generatedText = "";
  
  if (styleType.includes("文艺清新")) {
    generatedText = `在这座僻静的古镇深处，有一间木工坊，门扉斑驳，窗棂透着岁月的气息。我漫步走进去的那一刻，阳光恰好从窗户斜射进来，在地板上铺开一片温润的光晕，木屑在光线中悠然浮动。

工坊主人是个年过半百的匠人，他的指尖刻满了年轮与纹路，如同他所抚摸的每一件木器。他总是微微弓着背，目光却专注如初学者。掌心的茧子讲述着与木材相伴的漫长时光，那份耐心仿佛能与千年树龄的古木对话。

角落里堆放着各式各样的老物件，它们安静地等待着重获新生。一张旧桌几，边角已经磨损，但那纹路依然清晰可辨；一个老柜子，雕花虽已模糊，却仍能看出当年的灵动。匠人的手在这些木器上游走，仿佛在阅读一部关于时光的书籍。

他的动作很慢，却很坚定。修复一件老物件并非简单地刨光打磨，而是要与木头对话，感受它的呼吸与脉络。我静静地看着他用细砂纸一点点抚平岁月留下的伤痕，再用特制的蜡小心翼翼地涂抹，让木头重新焕发出温润的光泽。

在微澜的下午，阳光穿过尘埃铺洒在工坊的各个角落，为所有物件都镀上一层梦幻的金边。那些年轮纹路在光影交错中如同乐谱，记载着大地与天空的对白。这里的时间仿佛被木香凝固，静谧而悠长。

"每件木器都有自己的性格，"匠人轻声说道，"有些温顺，有些倔强。修复它们，不是要抹去岁月，而是要尊重它们的过往。"他的声音和手中的动作一样轻柔而坚定，透着一种与自然共舞的智慧。

他递给我一块磨平的木板，我的指尖能感受到那光滑如绸缎的质感，以及隐藏在表面下的木质纹理。这块木板的年轮如此清晰，一圈一圈，记录着它所经历的每一个春夏秋冬。"这是一段凝固的时光，"他说，"也是一段流动的故事。"

偶尔，会有老物件的主人前来取件，他们的眼中总是氤氲着惊喜与怀念。一张童年坐过的小板凳，一个陪伴多年的木盒子，都承载着无法复制的记忆。那一刻，匠人脸上会露出淡淡的笑意，那是手艺人最珍贵的回报。

夕阳西斜，工坊门前的老树投下长长的影子。匠人依然弓着背，沉浸在自己的世界里。在快节奏的时代，他的坚守如同一股清泉，悄无声息地流淌，滋养着那些愿意停下脚步的心灵。

我离开时，回头看了一眼那间沐浴在暮色中的木工坊。在那里，时间有着不同的刻度，光阴被年轮纹路所铭记，每一件木器都是一个关于等待与重生的故事。而那位匠人，则是这些故事最忠实的讲述者与见证者。`;
  } else if (styleType.includes("叙事性")) {
    generatedText = `古镇的日子总是过得很慢，尤其到了午后，阳光会变得异常慵懒。正是在这样一个宁静的时刻，我第一次走进了那家不起眼的木工坊。

推门而入，浓郁的木香扑面而来。灰尘在阳光下跳跃，却不显得凌乱，反而有种说不出的和谐。木工坊的主人是位满头银发的老匠人，他似乎对我的到来毫无察觉，依旧专注于手中的活计。

我不想打扰，只是安静地站在一旁观察。工坊内堆放着各种各样的木材，有刚刚砍伐不久的，散发着新鲜的气息；也有历经沧桑的老木头，上面的年轮纹路清晰可见，记录着它们各自的故事。

老匠人手中正在修复的是一个古旧的木质相框。他的动作轻柔而熟练，就像医生在治愈一位老朋友。我注意到他的手指上满是老茧，那是岁月和木料摩擦的印记。有一瞬间，我竟分不清是他在塑造木头，还是木头在诉说他的人生。

"您是做木器修复的？"最终，我忍不住打破了沉默。

老人抬起头，眼神中带着匠人特有的专注与从容。"不止是修复，"他说，"更是对话。每一件木器都有自己的语言，只是很少有人懂得倾听。"

接下来的几个小时，我沉浸在老人的世界里。他告诉我，古老的木器之所以珍贵，不仅因为它们的年代久远，更因为它们承载着无数人的触摸与情感。一个简单的木碗，可能陪伴了一个家庭几代人；一张木椅，可能见证了无数次家庭团聚；一个小木盒，或许保存着某人一生中最珍贵的秘密。

"看这些年轮，"老人指着一块切面光滑的木板说道，"每一圈都是一年的故事。宽的是丰收年，窄的是艰难时。木头不会说谎，它记录的都是真实。"

随着交谈的深入，我了解到老人已经守在这间木工坊四十多年了。科技的发展让手工木器逐渐被工业产品取代，但他始终相信，那些经过匠人之手的木制品有着机器永远无法企及的温度和灵魂。

"年轻人都追求快，但木头教会我的是慢。"老人一边说，一边用砂纸细致地打磨着相框的一角，"了解木头的脾气，尊重它的纹路，才能让它展现最美的一面。"

傍晚时分，有位老太太来取一个修复好的木梳。那是她祖母留下的，陪伴了她大半辈子。当她看到焕然一新又保留着原有痕迹的木梳时，眼中闪烁的光芒让我明白了老匠人工作的意义。

离开木工坊时，天色已晚。老人送我到门口，顺手递给我一个小木雕——那是一片树叶的形状，纹路细致得几乎可以看到叶脉。"希望你记住，"他说，"就像树叶离不开年轮的滋养，人也不应该忘记传统的根基。"

直到今天，每当我抚摸那片木叶，感受指尖下细腻的纹路，就仿佛又回到了那个阳光温柔的午后，与那位守护木器记忆的老匠人重逢。在高速运转的现代生活中，那间木工坊就像一个时光的庇护所，提醒着我们慢下来，倾听那些被岁月打磨得愈发动人的故事。`;
  } else {
    generatedText = `在这个千变万化的世界里，古镇的木工坊仿佛是时间遗忘的角落。推开那扇吱呀作响的木门，木屑的芬芳混合着岁月的气息扑面而来，让人一瞬间与喧嚣的现代生活拉开了距离。

木工坊的主人是一位鬓角斑白的老匠人，他的手粗糙却灵巧，像是与木头有着某种神秘的默契。每当他的手指抚过一块木材，仿佛能听懂它们沉默的语言。我常常驻足在工坊门口，看他专注地工作，那专注的眼神中似乎包含了整个宇宙的奥秘。

最令人着迷的是那些年轮纹路。每一圈都是一个轮回，记录着树木生长的每一个春夏秋冬。老匠人告诉我，判断一块木头的价值，不仅要看它的种类和硬度，更要看它的纹路是否有故事。那些经历过风霜雨雪的木头，纹路往往更加丰富多变，制成的器物也更加坚韧耐用。

"木器修复不仅仅是一种技艺，更是一种传承。"老匠人常这样说。他的工作台上总是摆着各种各样的老物件：一把曾陪伴某位祖母度过漫长岁月的摇椅，一个承载了三代人记忆的梳妆台，或者是一个简单却充满温情的木碗。这些看似普通的物件，在他手中仿佛获得了新生，却又保留着岁月的痕迹。

有一次，我看到他修复一个古老的木盒。那木盒表面已经斑驳不堪，但纹路依然清晰。他小心翼翼地处理每一处细节，就像医生在治疗一位饱经风霜的老人。"每一道裂纹都是它生命的一部分，"他说，"我们不是要抹去这些痕迹，而是要让它们讲述更完整的故事。"

光阴如水，静静流淌。在这个快节奏的时代，木工坊仿佛是一个时间的孤岛，让人得以暂时逃离现代生活的喧嚣。每一次推门而入，都能感受到一种难以言喻的宁静，仿佛灵魂也随之沉淀下来。

匠人的坚守是一种无言的力量。在这个几乎所有物品都可以批量生产的时代，他依然坚持着手工的温度与情感。他的每一件作品都凝聚着时间的重量，都是独一无二的存在。这种坚守不仅仅是对传统工艺的执着，更是对生活态度的诠释。

我曾问他为什么选择这样一条看似孤独的道路。他没有立即回答，而是指着工作台上的一块木头说："看到这些纹路了吗？它们看似杂乱，实则有序。就像我们的人生，表面上可能充满变数，但内在却遵循着自己的规律。我选择与木头对话，是因为它们教会了我如何聆听内心的声音。"

偶然的一次，我带着一个老旧的木质相框来到木工坊。那是我祖父留下的唯一遗物，已经残破不堪。老匠人接过相框，眼神中流露出罕见的惊喜："这是一种已经很少见的木材，纹理非常特别。"他答应为我修复它，但不是简单地让它恢复如新，而是保留它所承载的记忆与故事。

几天后，当我再次踏入木工坊，看到焕然一新却依然保持着岁月痕迹的相框时，一种莫名的感动涌上心头。那一刻，我终于理解了老匠人所说的"与木头对话"是什么意思。那不仅是一种技艺，更是一种生活的智慧——尊重自然，尊重时间，尊重生命本身的痕迹。

在离开木工坊的路上，夕阳将老匠人的身影拉得很长。那一刻，我忽然意识到，在这个快速变化的世界里，正是这样的坚守与传承，才让我们不至于迷失方向。年轮纹路不仅仅是木头的记忆，也是我们文化的根脉，连接着过去、现在与未来。`;
  }
  
  return generatedText;
}

// 人味改写提示词模板
export const HUMANIZE_TEXT_PROMPT = `# 人味改写提示词模板 v1.0
基于下列方式改写文本，生成更有"人味"的文章：
"""
{
"真实人类思维文本范式": {
"核心原则": [
"思维碎片化：人类思维不是线性的，而是充满跳跃、联想和中断",
"身体感知优先：身体状态深刻影响思维内容和情绪",
"矛盾并存：内心冲突和矛盾是常态，不需要解决",
"琐事干扰：日常琐事和随机想法经常打断深刻思考",
"不完美表达：语言表达有重复、犹豫和不精确"
],
"文本结构框架": {
"身体层面": {
"占比": "20-30%",
"要素": [
"插入具体的身体不适感",
"使用具体而微小的细节",
"身体需求会打断思考"
]
},
"情绪层面": {
"占比": "15-25%",
"要素": [
"情绪波动无需合理原因",
"同时存在矛盾情绪",
"使用内在自我批评",
"加入无来由的情绪爆发"
]
},
"思维层面": {
"占比": "30-40%",
"要素": [
"随机联想：当前事物触发无关记忆",
"琐事插入：日常担忧突然闯入",
"自我怀疑：质疑自己的动机和决定",
"实用担忧：关于物质条件的现实考虑"
]
},
"现实干扰": {
"占比": "15-20%",
"要素": [
"计划失败",
"设备故障",
"物品损坏",
"意外发现"
]
}
},
"语言技巧": {
"口语化表达": [
"加入语气词",
"使用不完整句",
"自我对话"
],
"打破流畅叙事": [
"突然转换话题",
"中断自己的思路",
"使用省略号表示思维跳跃"
],
"减少华丽修辞": [
"避免过度文学化的比喻",
"用朴实直接的表达代替优美句子",
"保留一些重复和赘述"
]
}
}
"""

请将我提供的文本根据上述"真实人类思维文本范式"进行改写，使文章更有人味。
要求：
1. 加入身体层面的描述（不适感、微小细节、身体需求）
2. 增加情绪波动和矛盾情绪
3. 插入随机联想和琐事打断
4. 使用口语化表达和不完整句
5. 打破流畅叙事，加入思维跳跃
6. 减少华丽修辞，保留重复和赘述

保持文章原有主题和大致内容，但让表达方式更接近真实人类思维过程。`;

/**
 * 人味化处理文章
 * @param mimicText 仿写的文章
 * @returns 人味化后的文章
 */
export async function humanizeText(mimicText: string): Promise<string> {
  // 实际实现中，这里应该调用大语言模型API
  // 将HUMANIZE_TEXT_PROMPT和mimicText一起发送给API
  
  // 这里使用模拟数据进行演示
  await new Promise(resolve => setTimeout(resolve, 2500));
  
  // 模拟人味化后的文章（按照范式来调整示例文本）
  return `我走进古镇那间木工坊时，手指无意识地摸了摸额头的汗珠——夏日的午后总是这样闷热。工坊里有股特别的味道，木屑混着些许霉味，又带点松油的清香，说不上多好闻，却让人莫名安心。

匠人头也没抬，只顾着摩挲手中那件看起来已有些年头的木器。我注意到他的手指上有一道新鲜的小伤口，应该是不小心划到的。站了半天腿有点酸，我挪了挪位置，地板发出轻微的吱呀声。

"您好，"我打了招呼，声音比想象中要小，不知道他有没有听见。其实我也不太确定自己为什么会走进这间小店，可能就是被那些摆在门口的木制品吸引了吧。天哪，我是不是应该先问问能不能参观一下？这样贸然进来会不会显得很冒昧？

老匠人终于抬起了头，目光平和地看着我。他的眼角有很深的皱纹，眼神却意外地清亮。那种专注的神态让我有些羡慕，想起自己总是无法长时间集中在一件事情上，老是被手机通知或者突然冒出来的想法打断。哦，对了，待会儿得记得回复老板的那条消息...

"年轮有时候会说话，"他突然开口，把我的思绪拉了回来，"就看有没有人愿意听。"

我点点头，其实没太明白他的意思，但又不好意思再问。肚子不合时宜地咕噜了一声，我有点尴尬，早知道出门前应该先吃点东西的。希望他没有注意到。

工坊里的光线很特别，透过布满灰尘的窗户斜斜地照进来，给木屑镀上一层金边。我想拍张照片发朋友圈，但又怕显得不尊重，手伸到一半又缩了回来。这种氛围确实很难用照片捕捉，有点像那次去看日出，怎么拍都不如亲眼所见来得震撼。

"想摸摸看吗？"老匠人指了指桌上的一块木板，打断了我的胡思乱想。

我点点头，小心翼翼地拿起那块木板。表面出乎意料的光滑，有种温润的质感。那些年轮纹路在阳光下显得格外清晰，像是某种神秘的地图。我忽然想起小时候看过的一本童话书，里面有个通过树轮穿越时空的故事...等等，那到底是哪本书来着？

"这是...楠木？"我试着猜测，虽然其实完全不懂。

老匠人微笑了一下，我猜我说错了。有点尴尬，但他似乎并不在意。"是梨木，已经有七十多年了。"

七十多年...那岂不是经历了很多事情？它是从哪里来的呢？我想问，但转念一想又觉得问这么多可能会打扰到老人家工作。我的手指不自觉地沿着年轮纹路抚摸着，这种触感真的很奇妙。

我的手机在口袋里震动了一下，多半是又有新的工作邮件。最近这个项目真的很烦人，客户总是改需求，但截止日期却一点都不肯延后。唉，要不是为了房贷，真想辞职去做点自己喜欢的事情。就像眼前这位老匠人，至少他在做自己热爱的工作吧？

"每一道纹路都是一个故事，"老匠人说，仿佛看穿了我的心思，"有些年份的轮宽，有些则窄。就像人生一样，有丰收的季节，也有艰难的时期。"

我点点头，突然有点想哭，也不知道为什么。可能是因为最近太累了吧。或者是这个安静的下午，这个不紧不慢修复木器的老人，让我意识到自己的生活节奏有多么疯狂。

"您修复这些老物件多久了？"我问，同时注意到角落里摆放着各种各样的木制品，有些看起来很古老。

"四十多年了，"他回答，语气里既有骄傲也有一丝疲惫，"这行现在没什么人愿意学了。"

我点点头，不知道该说什么好。四十年专注于一件事情，我甚至无法想象那是什么感觉。忽然觉得有点口渴，早知道应该带瓶水出门的。

就在这时，门外传来了脚步声。一位老太太走了进来，手里小心翼翼地捧着一个木质相框。看到她的那一刻，不知怎么的，我想起了我奶奶。她也总是那么小心地对待家里的老物件，仿佛那些东西都有灵魂一样。

也许，它们确实有吧？在这个一切都变得越来越快的世界里，这些历经岁月打磨的木器，还有这位坚持着老手艺的匠人，或许正是我们所需要的提醒——关于耐心、关于专注、关于与时间和平相处的智慧。`;
}
